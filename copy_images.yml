- hosts: k3s_all
  gather_facts: true
  remote_user: root
  become: yes
  vars:
    ansible_become_pass: "ubuntu"

  tasks:
  - name: create directory if they don't exist
    file:
      path: "{{ item }}"
      state: directory
      owner: root
      group: root
      mode: 0775
    loop:
    - /var/lib/rancher/k3s/agent/images/
    - /root/k3s

  - name: Copy K3S image and binary
    copy:
      src: "{{ item.src }}"
      dest: "{{ item. dest }}"
      owner: root
      group: root
      mode: 0775
    with_items:
    - src: /Users/tomasjartymyk/K3s/k3s-airgap-images-amd64.tar.gz
      dest: /root/k3s
